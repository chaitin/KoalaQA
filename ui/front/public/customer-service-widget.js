var __async=(n,t,e)=>new Promise((i,o)=>{var a=n=>{try{s(e.next(n))}catch(t){o(t)}},r=n=>{try{s(e.throw(n))}catch(t){o(t)}},s=n=>n.done?i(n.value):Promise.resolve(n.value).then(a,r);s((e=e.apply(n,t)).next())});!function(){"use strict";!function(){var n,t,e,i,o;const a={baseUrl:(null==(n=window.CustomerServiceConfig)?void 0:n.baseUrl)||(()=>{if("undefined"!=typeof document&&document.currentScript){const t=document.currentScript.src;if(t)try{const n=new URL(t);return n.origin+n.pathname.substring(0,n.pathname.lastIndexOf("/"))}catch(n){}}return window.location.origin})(),iframePath:(null==(t=window.CustomerServiceConfig)?void 0:t.iframePath)||"/customer-service",position:(null==(e=window.CustomerServiceConfig)?void 0:e.position)||"bottom-right",buttonSize:(null==(i=window.CustomerServiceConfig)?void 0:i.buttonSize)||56,buttonColor:"#fff",buttonHoverColor:"#fff",zIndex:(null==(o=window.CustomerServiceConfig)?void 0:o.zIndex)||9999},r=`\n    .cs-widget-button {\n      position: fixed;\n      ${"bottom-left"===a.position?"left":"right"}: 24px;\n      bottom: 88px;\n      min-width: ${a.buttonSize}px;\n      max-width: ${a.buttonSize}px;\n      height: ${a.buttonSize}px;\n      padding: 0;\n      border-radius: 50%;\n      background: linear-gradient(135deg, var(--cs-primary-color, ${a.buttonColor}) 0%, var(--cs-primary-hover-color, ${a.buttonHoverColor}) 100%);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      cursor: pointer;\n      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15), inset 0 1px 1px rgba(255, 255, 255, 0.2);\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n      z-index: ${a.zIndex};\n      outline: none;\n      animation: cs-widget-entrance 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) backwards;\n      overflow: hidden;\n      box-sizing: border-box;\n    }\n    \n    .cs-widget-button:hover {\n      max-width: 300px;\n      padding: 0 24px;\n      gap: 12px;\n      border-radius: 30px;\n      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2), inset 0 1px 1px rgba(255, 255, 255, 0.3);\n      filter: brightness(1.1);\n      border: 1px solid transparent;\n      background: \n        linear-gradient(135deg, var(--cs-primary-color, ${a.buttonColor}) 0%, var(--cs-primary-hover-color, ${a.buttonHoverColor}) 100%) padding-box,\n        linear-gradient(90deg, rgba(0, 156, 200, 1), rgba(0, 99, 151, 1)) border-box;\n    }\n    \n    .cs-widget-button:active {\n      transform: translateY(-2px) scale(0.98);\n    }\n    \n    .cs-widget-button-icon {\n      width: 28px;\n      height: 28px;\n      object-fit: contain;\n      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));\n      transition: transform 0.4s ease;\n      flex-shrink: 0;\n    }\n    \n    .cs-widget-button-text {\n      background: linear-gradient(0deg, #009CC8 0%, #006397 100%);\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-clip: text;\n      color: transparent;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      opacity: 0;\n      max-width: 0;\n      transition: all 0.4s ease;\n    }\n\n    .cs-widget-button:hover .cs-widget-button-text {\n      opacity: 1;\n      max-width: 100px;\n    }\n    \n    .cs-widget-modal {\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: transparent;\n      display: none;\n      align-items: flex-end;\n      justify-content: flex-end;\n      padding: 24px;\n      ${"bottom-left"===a.position?"padding-left":"padding-right"}: 100px;\n      z-index: ${a.zIndex+1};\n      animation: cs-fade-in 0.2s ease-out;\n      pointer-events: none;\n    }\n    \n    .cs-widget-modal.cs-active {\n      display: flex;\n    }\n    \n    .cs-widget-modal-content {\n      position: relative;\n      width: 400px;\n      max-width: calc(100vw - 48px);\n      height: 600px;\n      max-height: calc(100vh - 120px);\n      background: \n        linear-gradient(#fff, #fff) padding-box,\n        linear-gradient(90deg, rgba(0, 156, 200, 1), rgba(0, 99, 151, 1)) border-box;\n      border: 1px solid transparent;\n      border-radius: 12px;\n      box-shadow: 0 24px 80px rgba(0,0,0,0.3);\n      overflow: hidden;\n      animation: cs-slide-up 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n      pointer-events: auto;\n    }\n    \n    .cs-widget-close {\n      position: absolute;\n      top: 8px;\n      right: 8px;\n      width: 28px;\n      height: 28px;\n      border-radius: 50%;\n      background: transparent;\n      backdrop-filter: blur(8px);\n      border-color: transparent;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 10;\n      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n      outline: none;\n      color: #666;\n    }\n    \n    .cs-widget-close:hover {\n      background: white;\n      color: #333;\n      transform: scale(1.05);\n      box-shadow: 0 6px 16px rgba(0,0,0,0.15);\n    }\n    \n    .cs-widget-close svg {\n      display: block;\n      width: 14px;\n      height: 14px;\n    }\n    \n    .cs-widget-iframe {\n      width: 100%;\n      height: 100%;\n      border: none;\n      border-radius: 8px;\n    }\n    \n    @keyframes cs-fade-in {\n      from {\n        opacity: 0;\n      }\n      to {\n        opacity: 1;\n      }\n    }\n    \n    @keyframes cs-slide-up {\n      from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n      }\n    }\n\n    @keyframes cs-widget-entrance {\n      from {\n        opacity: 0;\n        transform: translateY(40px) scale(0.5);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n      }\n    }\n    \n    @media (max-width: 768px) {\n      .cs-widget-modal {\n        padding: 0;\n      }\n\n      .cs-widget-modal-content {\n        width: 100%;\n        height: 100%;\n        max-width: 100%;\n        max-height: 100%;\n        border-radius: 0;\n      }\n      \n      .cs-widget-iframe {\n        border-radius: 0;\n      }\n    }\n    .cs-widget-icon-wrapper {\n      position: relative;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 28px;\n      height: 28px;\n      flex-shrink: 0;\n    }\n\n    .cs-widget-star {\n      position: absolute;\n      right: -6px;\n      bottom: -3px;\n      pointer-events: none;\n      z-index: 10;\n      transition: all 0.3s ease;\n      width: 14px;\n      height: 14px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n  `;!function(){__async(this,null,function*(){var n,t,e;if(window.self!==window.top)return;let i="";try{const o=new AbortController,r=setTimeout(()=>o.abort(),3e3),[s,d]=yield Promise.all([fetch(`${a.baseUrl}/api/system/web_plugin`,{signal:o.signal}),fetch(`${a.baseUrl}/api/bot`,{signal:o.signal})]);if(clearTimeout(r),s.ok){const e=yield s.json(),i=window.location.origin,o=i===new URL(a.baseUrl).origin;if(!1===(null==(n=null==e?void 0:e.data)?void 0:n.plugin))return;if(o&&!1===(null==(t=null==e?void 0:e.data)?void 0:t.display))return}if(d.ok){const n=yield d.json();if(null==(e=null==n?void 0:n.data)?void 0:e.avatar){const t=n.data.avatar;if(t.startsWith("http")||t.startsWith("//"))i=t;else{const n=a.baseUrl.endsWith("/")?a.baseUrl.slice(0,-1):a.baseUrl,e=t.startsWith("/")?t.substring(1):t;i=`${n}/${e}`}}}}catch(s){console.warn("Failed to check widget status:",s)}const o=()=>{!function(){const n=document.createElement("style");n.textContent=r,document.head.appendChild(n)}(),function(n){const t=n||`${a.baseUrl}/logo.svg`,e=document.createElement("button");e.className="cs-widget-button",e.innerHTML=`\n      <span class="cs-widget-button-text">智能客服</span>\n      <div class="cs-widget-icon-wrapper">\n        <img src="${t}" alt="Logo" class="cs-widget-button-icon" />\n        <div class="cs-widget-star">\n          <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 13 14" fill="none">\n            <path d="M6.25708 0.941406L8.03816 5.16631L12.5511 6.55184L8.27117 8.78913L6.96321 13.1665L4.72911 8.94827L0.461914 7.21852L4.54226 5.37257L6.25708 0.941406Z" fill="#009CC8"/>\n          </svg>\n        </div>\n      </div>\n    `,e.setAttribute("aria-label","打开智能客服");const i=document.createElement("div");i.className="cs-widget-modal",i.innerHTML=`\n      <div class="cs-widget-modal-content">\n        <button class="cs-widget-close" aria-label="关闭"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>\n        <iframe class="cs-widget-iframe" src="${a.baseUrl}${a.iframePath}?is_widget=1" title="客服助手"></iframe>\n      </div>\n    `,document.body.appendChild(e),document.body.appendChild(i);const o=i.querySelector(".cs-widget-close");e.addEventListener("click",()=>{i.classList.contains("cs-active")?i.classList.remove("cs-active"):i.classList.add("cs-active")}),o&&o.addEventListener("click",()=>{i.classList.remove("cs-active")}),document.addEventListener("keydown",n=>{"Escape"===n.key&&i.classList.contains("cs-active")&&i.classList.remove("cs-active")}),window.addEventListener("message",n=>{n.data&&"CLOSE_WIDGET"===n.data.type&&i.classList.remove("cs-active")})}(i)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()})}(),window.CustomerServiceWidget={version:"1.0.0",open:()=>{const n=document.querySelector(".cs-widget-modal");n&&n.classList.add("cs-active")},close:()=>{const n=document.querySelector(".cs-widget-modal");n&&n.classList.remove("cs-active")}}}()}();